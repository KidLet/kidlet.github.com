<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>利用NodeJS搭建微信公众账号 | KidLet</title>
  <link rel="stylesheet" href="/assets/css/base.css">
  <link rel="stylesheet" href="/assets/css/post.css">
  <link rel="stylesheet" href="/assets/css/code.css">
  <meta name="author" content="KidLet">
  
    <meta content="随着微信的流行，不少商家和应用也开始入住公众账号。并且不久前微信的开放平台正式上线了，于是我自己也写了一个查询天气的应用来尝试下。" name="description">
  

  
    <meta content="JavaScript, js, nodejs, node, 微信， 微信公共" name="keywords">
  

</head>

<body>

  <div class="site">

    <header class="site-header">
      <div class="site-header-title">
        <h1><a href="/" title="KidLet" rel="KidLet">KidLet</a></h1>
        <h2>享受生活，热爱编程</h2>
      </div>

    <nav class="site-nav">
      <ul>
        
        <li>
          <a href="/" title="Home">Home</a>
        </li>
<!--        
        <li>
          <a href="/doing.html">Doing</a>
        </li>
-->
        <li>
          <a href="/read.html">READ</a>
        </li>

        <li>
          <a href="#">About</a>
        </li>


        <li class="site-nav-search">
          <form action="#">
            <input type="text">
            <input type="submit" value="搜索">
          </form>
        </li>

      </ul>
    </nav>

    </header>

    <div class="wrapper">
  <div class="list-content">
    <article>
	<header class="entry-header">
		<h1 class="entry-title">
			利用NodeJS搭建微信公众账号
		</h1>

		<div class="entry-meta">
		2013-04-19
		</div>

	</header>

	<div class="entry-content">
		<h1>NodeJS</h1>

<p>随着近几年JavaScript的兴起而出现的一种借助V8引擎使得JavaScript的执行速度非常快，从而用于服务器来处理数据。</p>

<p>不同的是，NodeJS是采用非阻塞事件驱动的方式，这样可以大大的提高网络的并发量。当然这样做也会存在一定的局限性。譬如：对于每个事件处理的时间不能太长。</p>

<h1>微信公共账号</h1>

<p>随着微信的流行，各种商家也开始入住微信的开发平台。并且在前不久微信也正式发布了他们的开发平台。</p>

<p>开发平台与我们自己服务器之间的交互是采用HTTP协议，以XML格式进行交互</p>

<p>之前就做好了这个应用，可以简单查询天气。但是由于服务器在国外，而微信又有5秒内未返回响应则自动断开连接的限制，导致有时候查询返回结果失败。</p>

<p>昨晚稍微改进了下“用户交互”，并且尝试着如何优化来避免微信的限制。</p>

<p>由于我是通过抓取“新浪天气”的信息返回给用户，抓取时间相对会长一点，开始想着能不能只抓取页面的一部分就让 request 返回。但是似乎并没有这种接口的提供。后来就尝试的可以先返回 信息的一部分，比如发送的用户、接受用户、时间。然后才开始抓取天气。等到天气抓取到后在把余下的信息返回给微信开放平台。与之前不同的是我是将所有信息准备好了才一次性返回给微信。导致会出现超时的现象。似乎改进后效果有明显改善，基本不存在查询超时的情况了。</p>

<p>这几天发现情况还是没有得到改善，看来只能尽量采用国内的服务器以避免这种情况吧。等接下来忙完实习的事情，把源码放到GitHub上。</p>

	</div>

	<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"kidlet"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- Duoshuo Comment END -->

</article>
  </div>

  <div class="list-widget-area">
    
    <aside class="widget widget_recent_entries">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
        <li>
          <a href="/2013/06-16/pthread.html" title="多线程引起的“内存泄露”">多线程引起的“内存泄露”</a>
        <li>
        
        <li>
          <a href="/2013/06-03/vector.html" title="正确释放Vector的内存">正确释放Vector的内存</a>
        <li>
        
        <li>
          <a href="/2013/05-17/mykindle.html" title="入手Kindle Paperwhite">入手Kindle Paperwhite</a>
        <li>
        
        <li>
          <a href="/2013/05-12/acmdone.html" title="省赛结束">省赛结束</a>
        <li>
        
        <li>
          <a href="/2013/05-10/newtheme.html" title="博客新主题">博客新主题</a>
        <li>
        
      </ul>
    </aside>

    <aside class="widget widget_categories">
      <h3 class="widget-title">Categories</h3>
      <ul>

        
        <li>
          <a href="/categories/web前端" title="">web前端</a>
        </li>
        
        <li>
          <a href="/categories/算法" title="">算法</a>
        </li>
        
        <li>
          <a href="/categories/随笔" title="">随笔</a>
        </li>
        
        <li>
          <a href="/categories/javascript" title="">javascript</a>
        </li>
        
        <li>
          <a href="/categories/web" title="">web</a>
        </li>
        
        <li>
          <a href="/categories/linux" title="">linux</a>
        </li>
        
        <li>
          <a href="/categories/programming" title="">programming</a>
        </li>
                

      </ul>
    </aside>
  </div>
</div>

    <footer>
      <p>Proudly powered by Jekyll</p>
      <script src="http://s14.cnzz.com/stat.php?id=5036420&web_id=5036420&online=2" language="JavaScript"></script>
    </footer>

  </div>

</body>

</html>

